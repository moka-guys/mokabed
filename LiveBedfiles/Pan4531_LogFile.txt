This is a VCP3 R78 test BED file for CNV analysis using ExomeDepth

Save Pan4531 request form and transcript file

#Challenges making this BED:
    - Genes with multiple transcripts - these must be combined without duplicating regions, using bedtools subtract. 
      To allow for this the transcript list (the mokaBED input) was split into 3 files Pan4531.txt, Pan4531_duplicates.txt, Pan4531_extra.txt
    - From previous attempts to make this file (Pan4531) one transcript was found to cause a problem (SMN1) so will again be done manually.

#Save Mokabed outputs 

#Combining multiple transcripts

1) Merge Pan4531_extradata.bed and Pan4531_duplicatesdata.bed
    bedtools subtract -a Pan4531_extradata.bed -b Pan4531_duplicatesdata.bed >> Pan4531_duplicatesdata.bed

2) Add regions from Pan4531_duplicatesdata.bed not included in Pan4531data.bed
    bedtools subtract -a Pan4531_duplicatesdata.bed -b Pan4531data.bed >> Pan4531data.bed

#Delete Pan4531_duplicatesdata.bed Pan4531_extradata.bed

#Problematic SMN1 transcript
Mokabed was failing because cruzdb was returning multiple records for the same transcript.
As described in Pan3973_log.md a number of steps were performed to extract the regions from the UCSC table browser

This was done for Pan4531 and was saved as Pan4531_problemdata.bed
Pan3973_problemdata.bed file was downloaded from the git history at commit 982b443698 (https://github.com/moka-guys/mokabed/tree/982b443698683532c2a4a0032e0ae370742ad41a/LiveBedfiles)

Pan3973_problemdata.bed had +-10bp padding, to match the padding (30bp) in Pan4531data.bed regions were padded further +-20bp

#Add Pan4531_problemdata.bed to Pan4531data.bed
cat Pan4531_problemdata.bed >> Pan4531data.bed    There was no header to remove

##Remove problemdata.bed
rm Pan4531_problemdata.bed

## Add Pan3608
cat Pan3608.bed >> Pan4531data.bed

#Sort
sort Pan4531data.bed -k1,1V -k2,2n -k3,3n > Pan4531_sorted.bed